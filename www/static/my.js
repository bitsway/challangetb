function test(){navigator.geolocation.getCurrentPosition(onSuccess,onError)}function onSuccess(a){$("#lat").val(a.coords.latitude),$("#long").val(a.coords.longitude)}function onError(a){$("#lat").val(0),$("#long").val(0)}function loginCheckNew(){var a=$("#mobile").val(),b=$("#password").val();$.ajax({url:apipath+"passwordCheckNew?cid=CPMDT&dpid="+a+"&password="+b,success:function(b){if(loginResult=b,""==loginResult)alert("Sorry Network not available");else{localStorage.dpid=a;var c=loginResult.split("rdrd");if("YES"==c[0]){patient=c[1],sideeffectList=c[2],attentionList=c[3],localStorage.attentionList=attentionList,localStorage.sideeffectList=sideeffectList,$("#tempsideeffect").val(localStorage.sideeffectList),$("#sideeffectList").empty(),$("#sideeffectList").append(localStorage.sideeffectList).trigger("create"),$("#tempAttention").val(localStorage.attentionList),$("#attention").empty(),$("#attention").append(localStorage.attentionList).trigger("create");var d=patient.split(","),e=d.length;pListdiv="<div >আপনি যে রুগীর DOT করবেন তার নামটি সিলেক্ট করুন ।</div>";var f="";for(patientList="",i=0;i<e;i++){var g=d[i].split("fdfd");patId=g[0].toString(),f=g[1].toString(),patientList=patientList+'<a data-role="button" onClick="patientInfoNew(\''+patId+"')\" >"+f+"("+patId+")</a>"}pListdiv+=patientList,localStorage.pList=pListdiv,$("#PatientList").empty(),$("#PatientList").html(pListdiv).trigger("create");var h="#page1";$.mobile.navigate(h)}else"NO"==c[0]&&$("#myerror").html("Authentication Error")}},error:function(a){$("#errror").text(errror_str),url="#pagelogin",$.mobile.navigate(url)}})}function patientInfoNew(p){var page=1,tempSideeffectAction='<div id="checkboxes2" data-role="fieldcontain"><fieldset data-role="controlgroup" data-type="vertical"><legend>রোগীর পার্শপ্রতিক্রিয়া সমাধানে কি ব্যবস্তা নিয়া হইছিল?</legend><input id="checkConsultation" name="checkConsultation" type="checkbox"><label for="checkConsultation">আশ্বস্থ করা হলো </label><input id="checkReferral" name="checkReferral" type="checkbox"><label for="checkReferral">চিকিৎসকের সাথে পরামর্শ </label><input id="checkSEA4" name="checkSEA4" type="checkbox"><label for="checkSEA4">চিকিৎসকের কাছে প্রেরণ </label><input id="checkSEA3" name="checkSEA3" type="checkbox"><label for="checkSEA3">ভর্তির জন্য প্রেরণ </label></fieldset></div>',tempSideeffectCheck='<div data-role="fieldcontain"><fieldset data-role="controlgroup" ><legend> Ask the patient, whether he/she is <b>experiencing any side effect</b>:</legend><input id="radio1" name="yesno" value="Yes" type="radio"><label for="radio1"> Yes </label><input id="radio2" name="yesno" value="No" type="radio" checked="checked"><label for="radio2"> No </label></fieldset></div>',tempPaymentCheck='<div id="checkboxes2" data-role="fieldcontain"><fieldset data-role="controlgroup" ><legend>Ask the patient whether he/she has received nutritional support for this month</legend><input id="radio1" name="pPayment" value="1" type="radio"><label for="radio1"> Yes </label><input id="radio2" name="pPayment" value="0" type="radio" checked="checked" ><label for="radio2"> No </label></label></fieldset>',symptCIFTemp='<div data-role="fieldcontain"><fieldset data-role="controlgroup" ><legend> রোগীর নিকটে যারা থাকেন তাদের মধ্যে কারো যক্ষা রোগের লক্ষণ আছে কি না?</legend><input id="radio1" name="yesnoChild" value="Yes" type="radio"><label for="radio1">YES</label><input id="radio2" name="yesnoChild" value="No" type="radio" checked="checked"><label for="radio2"> NO</label></fieldset></div>';$.ajax({url:apipath+"patientInfoNew?cid=CPMDT&patient="+p,success:function(patient){pInfo=patient;var pInfoArray=pInfo.split("rdrd");$("#pID").val(p),$("#pInfo").html(pInfoArray[0]),$("#medicineList").empty(),$("#medicineList").append(pInfoArray[1]).trigger("create"),$("#ref_follow_up").empty(),$("#ref_follow_up").append(pInfoArray[4]).trigger("create"),$("#ref_contectList").empty(),$("#ref_contectList").append(pInfoArray[5]).trigger("create"),$("#sideEffectcheck").empty(),$("#sideEffectcheck").append(tempSideeffectCheck).trigger("create"),$("#sideeffectList").empty(),$("#sideeffectList").append(localStorage.sideeffectList).trigger("create"),$("#SideeffectActionDiv").empty(),$("#SideeffectActionDiv").append(tempSideeffectAction).trigger("create"),$("#symptCInFamily").empty(),$("#symptCInFamily").append(symptCIFTemp).trigger("create"),$("#paymentCheck").empty(),$("#paymentCheck").append(tempPaymentCheck).trigger("create"),$("#attention").empty(),$("#attention").append(localStorage.attentionList).trigger("create"),payment=eval(pInfoArray[2]),testResFlag=eval(pInfoArray[6]),chieldFlag=eval(pInfoArray[7]);var now=new Date,month=now.getUTCMonth()+1;startDt=now.getUTCFullYear()+"-"+month+"-"+now.getUTCDate()+" "+now.getHours()+":"+now.getMinutes()+":"+now.getSeconds(),$("div#nextButton").show();var url="#page2";$(location).attr("href",url),test()},error:function(a){$("#perror").text(errror_str),url="#page1",$.mobile.navigate(url)}})}function medicine(){var a=$("#pID").val();$.ajax({url:apipath+"sideeffectandmedicineCount?cid=CPMDT&patient="+a,success:function(a){""==a&&alert("Sorry Network not available"),$("#smCount").val(a),url="#Medication",$.mobile.navigate(url)}})}function madicationNext(){0==$("#medicineList").find("input[type=checkbox]:checked").length?$("#medError").text("Please Select One"):(url="#sideeffect_data",$.mobile.navigate(url))}function sideEffectUncheck(a){localStorage.chkName="check_S"+a.toString()}function sideEffect(){var b=$("input[name='yesno']:checked").val();if("Yes"==b)c="#sideeffect_data",$.mobile.navigate(c);else{var c="";$("#reffollowup_select").val();c="#symptContactInFamiy",$.mobile.navigate(c)}}function seDataNext(){0==$("#sideeffectList").find("input[type=checkbox]:checked").length?$("#seError").text("Please Select One"):"check_S15"==localStorage.chkName?(url="#patient_test_data",$.mobile.navigate(url)):(url="#sideeffect_action",$.mobile.navigate(url))}function sideEffectActionNext(){0==$("#SideeffectActionDiv").find("input[type=checkbox]:checked").length?$("#seAError").text("Please Select One"):(url="#patient_test_data",$.mobile.navigate(url))}function refFollowupNext(){var a="";a=0==testResFlag?"#patient_test_data":0==payment?"#payment_submit":"#symptContactInFamiy",$.mobile.navigate(a)}function testReportNext(){url="#symptContactInFamiy",$.mobile.navigate(url)}function paymentNext(){url="#symptContactInFamiy",$.mobile.navigate(url)}function symptCInFamilyNext(){var a=$("input[name='yesnoChild']:checked").val();"Yes"==a?(url="#patientChild",$.mobile.navigate(url)):(url="#final_submit",$.mobile.navigate(url))}function checkChild(){var a="";$("input[name='pchild']:checked").val(),$("#noOfPNearPatient").val(),$("input[name='pchildTest']:checked").val(),$("input[name='pchildRecIPT']:checked").val(),$("#NofChild").val(),$("input[name='pchildRecIPT']:checked").val();a="#final_submit",$.mobile.navigate(a)}function symptContactCheck(){var a="",b=$("#rName").val(),c=$("#relation_select").val(),e=($("#status_select").val(),$("#rName1").val()),f=$("#relation_select1").val();$("#status_select1").val();validFlag=!1,""==b.toString()&&""==c.toString()?validFlag=!0:""!=b.toString()&&""!=c.toString()&&(validFlag=!0),0==validFlag?($(".symptErrMsg").text("Invalid Name-1 data"),a="#sympt_contact"):""==e.toString()&&""==f.toString()?a=0==chieldFlag?"#patientChild":"#final_submit":""!=e.toString()&&""!=f.toString()?a=0==chieldFlag?"#patientChild":"#final_submit":($(".symptErrMsg").text("Invalid Name-2 data"),a="#sympt_contact"),$.mobile.navigate(a)}function finalSubmitNew(){var v,w,a=new Date,b=a.getUTCMonth()+1,c=a.getUTCFullYear()+"-"+b+"-"+a.getUTCDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds(),d=$("#pID").val(),f=($("input[name='yesno']:checked").val(),$("input[name='pPayment']:checked").val()),g=$("input[name='yesnoChild']:checked").val(),h=$("input[name='pchild']:checked").val(),i=$("#noOfPNearPatient").val(),j=$("input[name='pchildTest']:checked").val(),k=$("#NofChild").val(),l=$("input[name='pchildRecIPT']:checked").val(),n=$("input[name='checkConsultation']:checked").val()?1:0,o=$("input[name='checkReferral']:checked").val()?1:0,p=$("input[name='checkSEA3']:checked").val()?1:0,q=$("input[name='checkSEA4']:checked").val()?1:0,r="",t=$("#anci_med1").val()+"fdfd"+$("#anci_med2").val()+"fdfd"+$("#anci_med3").val(),u="",x=$("#smCount").val(),y=x.split(",");w=y[0],v=y[1];var z=$("#mobile").val(),A=$("#lat").val(),B=$("#long").val();""!=A&&void 0!=A||(A=0),""!=B&&void 0!=B||(B=0);var C=$("#reffollowup_select").val(),D=$("#test_result_select").val(),E=$("#culTestResult").val(),F=$("#rowid").val(),G=$("#rName").val(),H=$("#relation_select").val(),I=$("#status_select").val(),J=$("#rowid1").val(),K=$("#rName1").val(),L=$("#relation_select1").val(),M=$("#status_select1").val(),N="check_S",O=0;for(s=0;s<w;s++){O+=1;var P="#"+N+O,Q=$(P).is(":checked")?1:0;Q>0&&(u=0==s?$("input[name='"+N+O+"']:checked").val():u+"fdfd"+$("input[name='"+N+O+"']:checked").val())}var R="check_M",S=0;for(m=0;m<v;m++){S+=1;var T="#"+R+S,U=$(T).is(":checked")?1:0;U>0&&(r=0==m?$("input[name='"+R+S+"']:checked").val():r+"fdfd"+$("input[name='"+R+S+"']:checked").val())}$.ajax({url:apipath+"submitDataNew?cid=CPMDT&pid="+d+"&dpid="+z+"&pConsultation="+n+"&pSref="+o+"&sea3="+p+"&sea4="+q+"&pLatitude="+A+"&pLongitude="+B+"&pMedicine="+encodeURIComponent(r)+"&pAncimedicine="+encodeURI(t)+"&pSideeffectdata="+encodeURIComponent(u)+"&startDt="+startDt+"&endDt="+c+"&payment="+f+"&followUp="+encodeURIComponent(C)+"&reportTestlist="+encodeURIComponent(D)+"&rowid="+F+"&symptName="+encodeURI(G)+"&symptRelation="+H+"&symptStatus="+I+"&rowid1="+J+"&symptName1="+encodeURIComponent(K)+"&symptRelation1="+L+"&symptStatus1="+M+"&yesnoChild="+g+"&NofChild="+k+"&no_of_peple="+i+"&p_child_test="+j+"&pchildRecIPT="+l+"&culturalTestlist="+E+"&patientChild="+h,success:function(a){$("#pID").val(""),$("input[name='yesno']:checked").val(""),$("input[name='pPayment']:checked").val(""),$("input[name='yesnoChild']:checked").val(""),$("input[name='pchild']:checked").val(""),$("#noOfPNearPatient").val(""),$("input[name='pchildTest']:checked").val(""),$("#NofChild").val(""),$("input[name='pchildRecIPT']:checked").val(""),$("input[name='checkConsultation']:checked").val(""),$("input[name='checkReferral']:checked").val(""),$("input[name='checkSEA3']:checked").val(""),$("input[name='checkSEA4']:checked").val(""),$("#lat").val(""),$("#long").val(""),$("#reffollowup_select").val(""),$("#test_result_select").val(""),$("#culTestResult").val(""),$("#rowid").val(""),$("#rName").val(""),$("#relation_select").val(""),$("#status_select").val(),$("#rowid1").val(""),$("#rName1").val(""),$("#relation_select1").val(""),$("#status_select1").val(""),url="#submitreport",$(location).attr("href",url)},error:function(a){$("#err").text(errror_str),url="#final_submit",$.mobile.navigate(url)}})}function dotAnotherPt(){$("#errror").empty(),$("#perror").empty(),$("#err").empty(),$("#seError").empty(),$("#medError").empty(),url="#page1",$(location).attr("href",url)}function refreshPage(){$.mobile.changePage(window.location.href="http://127.0.0.1:8000/cpmdt/static/cpmdt_mobile/index.html",{allowSamePageTransition:!0,transition:"none",showLoadMsg:!1,reloadPage:!0})}function exit(){navigator.app.exitApp()}var apipath="http://app.businesssolutionapps.com/cpmdt/syncmobile_161210/",loginResult="",patient="",sideeffectList="",pInfo="",start_time="",payment=0,testResFlag=0,chieldFlag=0,errror_str="Network Not Available. Please Check that you have Internet active or Mobile have network signal. You can go to a place where network is available and submit the DOT. ";$(function(){""==localStorage.dpid||void 0==localStorage.dpid?$.mobile.navigate("#pagelogin"):($("#PatientList").empty(),$("#PatientList").html(localStorage.pList).trigger("create"),$("#sideeffectList").empty(),$("#sideeffectList").append(localStorage.sideeffectList).trigger("create"),$.mobile.navigate("#page1"))});var patient="";